
{% extends "layout.html" %}

{% block pageTitle %}
  GOV.UK Prototype Kit
{% endblock %}

{% block beforeContent %}
  {% from "breadcrumbs/macro.njk" import govukBreadcrumbs %}

  {{ govukBreadcrumbs({
  items: [
    {
      text: "Identity standard",
      href: "/standards-landing-page"
    },{
      text: "Assess how your identity service meets the standard",
      href: "/index"
    },
    {
      text: "How confident you can be in the person’s identity"
    }
  ]
  }) }}

{% endblock %}

{% block content %}

<!-- set variables -->
{% if data['passport-checks'] %}
  {% set passportCheck = data['passport-checks'] %}
{% else %}
  {% set passportCheck = "nil" %}
{% endif %}

{% if data['driving-licence-checks'] %}
  {% set licenceCheck = data['driving-licence-checks'] %}
{% else %}
  {% set licenceCheck = "nil" %}
{% endif %}

{% set elementE = data['element-e'] %}

{% if data['other-count'] == "1" and data['other-evidence-1-checks'] %}
  {% set evidence1 = data['other-evidence-1-checks'] %}
{% else %}
  {% set evidence1 = "0" %}
{% endif %}

{% set A1 = "You collect evidence that includes some basic information about the person." %}
{% set A2 = "You know the person needed to prove their identity to get the evidence. You also know that any digital information the evidence contains is protected by cryptographic security features." %}
{% set A3 = "You know the organisation made sure the evidence was received by the same person who applied for it." %}
{% set A4 = "You know the organisation made sure the person matches an image they had from a trusted source." %}

{% set B1 = "You’ve checked the person's details match the details held by the organisation that issued the evidence." %}
{% set B2 = "You’ve checked details of the evidence (such as its reference number or expiry date) match the details held by the organisation that issued it." %}
{% set B3 = "You’ve checked that any security features on the evidence are genuine." %}
{% set B4 = "You’ve checked the chip on the passport is genuine." %}

{% set E0 = "You don’t check the history of the identity." %}
{% set E1 = "You know the identity has interacted with other organisations or individuals over the past 3 months." %}
{% set E2 = "You know the identity has interacted with other organisations or individuals over the past 6 months." %}
{% set E3 = "You know the identity has interacted with other organisations or individuals over the past 1 year." %}
{% set E4 = "You know the identity has interacted with other organisations or individuals over the past 3 years." %}

{% set D0 = "You don’t check if the identity has been stolen or used fraudulently." %}
{% set D1 = "You’ve checked with a reliable and authoritative data source that the identity hasn’t been stolen or used fraudulently." %}
{% set D2 = "You’ve checked with a reliable and authoritative data source that the identity doesn’t belong to someone who’s died." %}
{% set D3 = "You’ve checked with at least one independent, reliable and authoritative data source that the identity hasn’t been stolen or used fraudulently." %}

{% set C0 = "You don’t check if the person is the person they’re claiming to be." %}
{% set C1 = "You’ve checked the person knows some things about the person they’re claiming to be." %}
{% set C2 = "You’ve checked they match the photo or biometric information on the evidence." %}
{% set C3 = "You’ve checked the person can complete tasks that only the person they’re claiming to be can do." %}
{% set C4 = "You’ve checked that their biometric information matches what’s on the evidence." %}


<!-- Set user's results based on answers -->

{% if data['evidence'].includes('Passport') %}

  {% set elementAPassportScore = 3 %}
  {% set elementAPassportDescription = A3 %}

  {% if passportCheck.includes('2') and passportCheck.includes('3') and passportCheck.includes('4') %}
    {% set elementBPassportScore = 4 %}
    {% set elementBPassportDescription = B4 %}
  {% elif passportCheck.includes('2') and ( passportCheck.includes('3') or passportCheck.includes('4') ) %}
    {% set elementBPassportScore = 3 %}
    {% set elementBPassportDescription = B3 %}
  {% elif passportCheck.includes('2') or passportCheck.includes('3') or passportCheck.includes('4') %}
    {% set elementBPassportScore = 2 %}
    {% set elementBPassportDescription = B2 %}
  {% elif passportCheck.includes('1')%}
    {% set elementBPassportScore = 1 %}
    {% set elementBPassportDescription = B1 %}
  {% else %}
    {% set elementBPassportScore = 0 %}
    {% set elementBPassportDescription = B0 %}
  {% endif %}

{% endif %}


{% if data['evidence'].includes('Driving licence') %}

    {% set elementADrivingLicenceScore = 3 %}
    {% set elementADrivingLicenceDescription = A3 %}

    {% if licenceCheck.includes('2') and licenceCheck.includes('3') %}
      {% set elementBDrivingLicenceScore = 3 %}
      {% set elementBDrivingLicenceDescription = B3 %}
    {% elif licenceCheck.includes('2') or licenceCheck.includes('3') %}
      {% set elementBDrivingLicenceScore = 2 %}
      {% set elementBDrivingLicenceDescription = B2 %}
    {% elif licenceCheck.includes('1') %}
      {% set elementBDrivingLicenceScore = 1 %}
      {% set elementBDrivingLicenceDescription = B1 %}
    {% else %}
      {% set elementBDrivingLicenceScore = 0 %}
      {% set elementBDrivingLicenceDescription = B0 %}
    {% endif %}

{% endif %}


{% if data['other-count'] == "1" %}

    {% if data['other-evidence-1-a'] == "no" %}
      {% set elementAOther1Score = 0 %}
      {% set elementAOther1Description = A0 %}
    {% elif data['other-evidence-1-b'] == "no" or  data['other-evidence-1-b'] == "no" or data['other-evidence-1-e'] == "no"%}
      {% set elementAOther1Score = 1 %}
      {% set elementAOther1Description = A1 %}
    {% elif data['other-evidence-1-f'] == "no" or data['other-evidence-1-g'] == "no" or data['other-evidence-1-h'] == "no" %}
      {% set elementAOther1Score = 2 %}
      {% set elementAOther1Description = A2 %}
    {% elif data['other-evidence-1-i'] == "no" %}
      {% set elementAOther1Score = 3 %}
      {% set elementAOther1Description = A3 %}
    {% elif data['other-evidence-1-i'] == "yes" %}
      {% set elementAOther1Score = 4 %}
      {% set elementAOther1Description = A4 %}
    {% endif %}

    {% if evidence1.includes('2') and evidence1.includes('3') %}
      {% set elementBOther1Score = 3 %}
      {% set elementBOther1Description = B3 %}
    {% elif evidence1.includes('2') or evidence1.includes('3') %}
      {% set elementBOther1Score = 2 %}
      {% set elementBOther1Description = B2 %}
    {% elif evidence1.includes('1') %}
      {% set elementBOther1Score = 1 %}
      {% set elementBOther1Description = B1 %}
    {% elif evidence1.includes('0') %}
      {% set elementBOther1Score = 0 %}
      {% set elementBOther1Description = B0 %}
    {% endif %}

{% endif %}

{% if data['element-e-a'].includes('n/a') %}
  {% set elementEScore = 0 %}
  {% set elementEDescription = E0 %}
{% elif elementE.includes('90') %}
  {% set elementEScore = 1 %}
  {% set elementEDescription = E1 %}
{% elif elementE.includes('180') %}
  {% set elementEScore = 2 %}
  {% set elementEDescription = E2 %}
{% elif elementE.includes('405') %}
  {% set elementEScore = 3 %}
  {% set elementEDescription = E3 %}
{% elif elementE.includes('1080') %}
  {% set elementEScore = 4 %}
  {% set elementEDescription = E4 %}
{% endif %}

{% if data['element-d-a'] == "no" %}
  {% set elementDScore = 0 %}
  {% set elementDDescription = D0 %}
{% elif data['element-d-b'] == "no" %}
  {% set elementDScore = 1 %}
  {% set elementDDescription = D1 %}
{% elif data['element-d-c'] == "1" %}
  {% set elementDScore = 3 %}
  {% set elementDDescription = D3 %}
{% else %}
  {% set elementDScore = 4 %}
  {% set elementDDescription = D3 %}
{% endif %}

{% if data['element-c-a'] == "no" or data['element-c-b-a'] == "no" %}
  {% set elementCScore = 0 %}
  {% set elementCDescription = C0 %}
{% elif (data['element-c-b'].includes('1') or data['element-c-b'].includes('2')) and data['element-c-b'].includes('3') %}
  {% set elementCScore = 3 %}
  {% set elementCDescription = C3 %}
{% elif data['element-c-b'].includes('1') or data['element-c-b'].includes('2') or data['element-c-b'].includes('3') %}
  {% set elementCScore = 2 %}
  {% set elementCDescription = C2 %}
{% endif %}

{% set risklevel = data['user-risk-level'] %}

  <div class="banner">
    <h1 class="banner-message">
      {% if risklevel == "dont-know" %}
        Based on the answers you’ve given your service could protect against a high level of fraud.
      {% elif risklevel == "low" %}
        Your checks do not protect against your service’s low risk of fraud.
      {% elif risklevel == "medium" %}
        Your checks do not protect against your service’s medium risk of fraud.
      {% elif risklevel == "high" %}
        Your checks do not protect against your service’s high risk of fraud.
      {% endif %}
    </h1>
  </div>

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

      {% if risklevel == "dont-know" %}
        <p>Your checks lower the risk of you accepting fake (or 'synthetic') identities or being targeted by third parties that have stolen other people’s identities.</p>

        <div class="govuk-inset-text govuk-!-margin-bottom-9">

          <p>
            <span style="font-weight:bold">Example</span><br>
            The Driver and Vehicle Licensing Agency’s (DVLA’s) <a href="https://www.gov.uk/view-driving-licence">View driving licence information</a> service lets users see information that’s not sensitive. There’s a low risk of identity fraud, so the service only needs low confidence in the user’s identity.
          </p>
        </div>
      {% endif %}

      <p>
        Based on your answers, your current identity checking process will give you:
        <ul class="govuk-list govuk-list--bullet govuk-!-margin-bottom-5">
          <li>
            <span style="font-weight:bold">
              {% if elementCScore == 4 %}
              	very high
              {% elif elementBPassportScore == 2 or elementBPassportScore == 3 or elementBPassportScore == 4 or elementBDrivingLicenceScore == 2 or elementBDrivingLicenceScore == 3 or elementBDrivingLicenceScore == 4 or elementBOther1Score == 2 or elementBOther1Score == 3 or elementBOther1Score == 4 or elementDScore == 3 or elementDScore == 4 or elementCScore == 3 %}
              	high
              {% elif elementDScore == 2 or elementCScore == 2 %}
              	medium
              {% elif elementDScore == 1 %}
              	low
              {% else %}
              	no
              {% endif %}
            protection</span> against someone using stolen evidence (this is evidence that doesn't belong to them)</li>
          <li>
            <span style="font-weight:bold">
              {% if elementCScore == 4 %}
                very high
              {% elif elementDScore == 3 or elementDScore == 4 or elementCScore == 3 %}
                high
              {% elif elementDScore == 2 or elementCScore == 2 %}
                medium
              {% elif elementDScore == 1 or elementCScore == 1 %}
                low
              {% else %}
              	no
              {% endif %}
            protection</span> against someone using stolen information (this is information that doesn't belong to them)</li>
          <li>
            <span style="font-weight:bold">
              {% if elementAOther1Score == 4 or elementBPassportScore == 4 or elementBDrivingLicenceScore == 4 or elementBOther1Score == 4 or elementEScore == 4 %}
                very high
              {% elif data['evidence'].includes('Passport') or data['evidence'].includes('Driving licence') or elementAOther1Score == 3 or elementBPassportScore == 3 or elementBDrivingLicenceScore == 3 or elementBOther1Score == 3 or elementEScore == 3 or elementDScore == 3  or elementCScore == 4 %}
                high
              {% elif elementAOther1Score == 2 or elementBPassportScore == 2 or elementBDrivingLicenceScore == 2 or elementBOther1Score == 2 or elementEScore == 2 or elementDScore == 2 %}
                medium
              {% elif elementAOther1Score == 1 or elementBPassportScore == 1 or elementBDrivingLicenceScore == 1 or elementBOther1Score == 1 or elementEScore == 1 or elementDScore == 1 or elementCScore == 3 %}
                low
              {% else %}
              	no
              {% endif %}
            protection</span> against someone using synthetic evidence (this is evidence that they’ve created for an existing person)</li>
          <li>
            <span style="font-weight:bold">
              {% if elementAOther1Score == 4 or elementBPassportScore == 4  or elementBDrivingLicenceScore == 4 or elementBOther1Score == 4 %}
                very high
              {% elif elementAOther1Score == 3 or  elementBPassportScore == 3 or elementBDrivingLicenceScore == 3 or elementBOther1Score == 3 or elementCScore == 4 %}
                high
              {% elif elementAOther1Score == 2 or elementBPassportScore == 2 or elementBDrivingLicenceScore == 2 or elementBOther1Score == 2 or elementCScore == 2 or elementCScore == 3 %}
                medium
              {% elif elementAOther1Score == 1 or elementBPassportScore == 1 or  elementBDrivingLicenceScore == 1  or elementBOther1Score == 1 or elementDScore == 1 or elementDScore == 2 or elementDScore == 3 or elementDScore == 4 or elementCScore == 1 %}
                low
              {% else %}
              	no
              {% endif %}

             protection</span> against someone using manipulated evidence (this genuine evidence which has been tampered with)</li>
        </ul>
      </p>

      <h2 class="govuk-heading-m">Recommended next steps</h2>

      <p>
        You need to meet at least 1 of the following identity profiles to to protect against a {{risklevel}} risk of fraud.
      </p>

      <h3 class="govuk-heading-s">Meeting profile A</h3>

      <p>
        You have a history score of 2, you need a history score of 3.
      </p>

      <h3 class="govuk-heading-s">Meeting profile B</h3>

      <p>
        You'll need to collect another piece of evidence with a strength score of 3 and a validity score of 2.
      </p>
      <p>
        You have a history score of 2, you need a history score of 3.
      </p>

    </div>
  </div>

{% endblock %}
